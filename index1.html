<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panda Max Fixed</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body { background: #0e1621; color: white; font-family: sans-serif; margin: 0; padding: 0; }
        .header { background: #17212b; padding: 20px; text-align: center; border-bottom: 2px solid #0088cc; }
        .balance { font-size: 32px; color: #fbbf24; font-weight: bold; margin: 10px 0; }
        
        .content { padding: 20px; padding-bottom: 100px; }
        .section { display: none; }
        .active { display: block; }
        
        .card { background: #1c2733; padding: 15px; border-radius: 10px; margin-bottom: 15px; border: 1px solid #2b3949; }
        .btn { display: block; width: 100%; padding: 12px; background: #0088cc; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; margin-top: 10px; text-align: center; text-decoration: none; }
        
        .nav { position: fixed; bottom: 0; width: 100%; background: #17212b; display: flex; border-top: 1px solid #2b3949; }
        .nav-btn { flex: 1; padding: 20px; text-align: center; color: #8e99a2; cursor: pointer; }
        .nav-active { color: #0088cc; font-weight: bold; border-top: 2px solid #0088cc; }

        /* Timer Overlay */
        #ad-box { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 999; flex-direction: column; align-items: center; justify-content: center; }
    </style>
</head>
<body>

    <div class="header">
        <div id="user-name">হ্যালো!</div>
        <div class="balance" id="bal-text">৳ 0.00</div>
    </div>

    <div class="content">
        <div id="home" class="section active">
            <div class="card">
                <h3>রেফার ইনকাম</h3>
                <p>প্রতি রেফারে ১০ টাকা। ১০ জন রেফার হলে উইথড্র করতে পারবেন।</p>
                <button class="btn" onclick="copyRef()">লিঙ্ক কপি করুন</button>
            </div>
        </div>

        <div id="task" class="section">
            <div class="card">
                <h3>ভিডিও অ্যাড</h3>
                <p>৳ ৫.০০ পাবেন। ১৫ সেকেন্ড দেখুন।</p>
                <button class="btn" onclick="startAd()">অ্যাড দেখুন</button>
            </div>
            <div class="card" id="yt-div">
                <h3>YouTube Sub</h3>
                <p>৳ ৫০.০০ পাবেন।</p>
                <button class="btn" style="background:#ff0000" onclick="openLink('https://www.youtube.com/@arshoppingmalls', 'yt')">Subscribe</button>
                <button id="yt-claim" class="btn" style="display:none; background:#2ed573" onclick="claimTask('yt', 50)">টাকা নিন</button>
            </div>
        </div>

        <div id="withdraw" class="section">
            <div class="card">
                <h3>উইথড্র</h3>
                <input type="number" id="w-amt" placeholder="টাকার পরিমাণ" style="width:90%; padding:10px; margin-bottom:10px;">
                <textarea id="w-ref-info" placeholder="১০ জন রেফারের ইউজারনেম..." style="width:90%; padding:10px;"></textarea>
                <button class="btn" onclick="withdrawReq()">সাবমিট করুন</button>
            </div>
        </div>
    </div>

    <div id="ad-box">
        <h1 id="timer" style="font-size: 60px; color:#0088cc">15</h1>
        <p>অ্যাড দেখা শেষ করে এখানে ফিরে আসুন</p>
        <button id="get-money" class="btn" style="display:none; width:200px; background:#2ed573" onclick="collectAdMoney()">বোনাস নিন</button>
    </div>

    <div class="nav">
        <div class="nav-btn nav-active" id="n-home" onclick="show('home', 'n-home')">HOME</div>
        <div class="nav-btn" id="n-task" onclick="show('task', 'n-task')">TASK</div>
        <div class="nav-btn" id="n-with" onclick="show('withdraw', 'n-with')">WITHDRAW</div>
    </div>

    <script>
        let tg = window.Telegram.WebApp;
        tg.expand();

        let data = JSON.parse(localStorage.getItem('panda_v3')) || { bal: 0, yt: false };

        function update() {
            document.getElementById('bal-text').innerText = "৳ " + data.bal.toFixed(2);
            if(data.yt) document.getElementById('yt-div').style.display = 'none';
            localStorage.setItem('panda_v3', JSON.stringify(data));
        }

        function show(id, btnId) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('nav-active'));
            document.getElementById(id).classList.add('active');
            document.getElementById(btnId).classList.add('nav-active');
        }

        function startAd() {
            tg.openLink("https://otieu.com/4/10557505");
            document.getElementById('ad-box').style.display = 'flex';
            let s = 15;
            let t = setInterval(() => {
                s--;
                document.getElementById('timer').innerText = s;
                if(s <= 0) {
                    clearInterval(t);
                    document.getElementById('timer').style.display = 'none';
                    document.getElementById('get-money').style.display = 'block';
                }
            }, 1000);
        }

        function collectAdMoney() {
            data.bal += 5; update();
            document.getElementById('ad-box').style.display = 'none';
            tg.showAlert("৫ টাকা যোগ হয়েছে!");
        }

        function openLink(url, id) {
            tg.openLink(url);
            setTimeout(() => { document.getElementById(id + '-claim').style.display = 'block'; }, 8000);
        }

        function claimTask(type, amt) {
            data.bal += amt;
            if(type === 'yt') data.yt = true;
            update();
            tg.showAlert("টাকা যোগ হয়েছে!");
        }

        function copyRef() {
            let id = tg.initDataUnsafe.user ? tg.initDataUnsafe.user.id : "user";
            tg.openLink("https://t.me/share/url?url=https://t.me/Red_Chilii_bot?start=" + id);
        }

        function withdrawReq() {
            let a = document.getElementById('w-amt').value;
            if(data.bal < 500) return tg.showAlert("৫০০ টাকা লাগবে!");
            tg.showAlert("রিকোয়েস্ট সফল!");
            data.bal -= a; update();
        }

        if(tg.initDataUnsafe.user) document.getElementById('user-name').innerText = "হ্যালো, " + tg.initDataUnsafe.user.first_name;
        update();
    </script>
</body>
</html>
