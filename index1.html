<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Panda Earn Max</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root { --primary: #0088cc; --bg: #0e1621; --card: #17212b; --accent: #fbbf24; --success: #2ed573; --danger: #ff4757; --text: #ffffff; }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', Roboto, sans-serif; }
        body { background-color: var(--bg); color: var(--text); padding-bottom: 80px; overflow-x: hidden; }

        /* Header & Balance */
        .header { padding: 30px 20px; background: linear-gradient(180deg, var(--card) 0%, var(--bg) 100%); text-align: center; border-bottom: 1px solid #242f3d; }
        .balance-title { font-size: 14px; color: #8e99a2; margin-bottom: 5px; }
        .balance-amount { font-size: 42px; color: var(--accent); font-weight: bold; text-shadow: 0 0 10px rgba(251, 191, 36, 0.2); }
        
        /* Navigation */
        .nav-bar { position: fixed; bottom: 0; width: 100%; height: 75px; background: var(--card); display: flex; justify-content: space-around; align-items: center; border-top: 1px solid #242f3d; z-index: 1000; }
        .nav-item { color: #8e99a2; font-size: 12px; text-align: center; flex: 1; cursor: pointer; padding: 10px 0; transition: 0.3s; }
        .nav-item.active { color: var(--primary); font-weight: bold; border-top: 3px solid var(--primary); }

        /* Pages */
        .page { display: none; padding: 20px; animation: fadeIn 0.4s ease; }
        .page.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* Task Cards */
        .section-title { font-size: 18px; margin-bottom: 15px; color: var(--primary); font-weight: bold; }
        .card { background: var(--card); padding: 18px; border-radius: 16px; margin-bottom: 15px; border: 1px solid #242f3d; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .card-title { font-size: 16px; font-weight: bold; }
        .reward-tag { background: rgba(46, 213, 115, 0.1); color: var(--success); padding: 4px 10px; border-radius: 8px; font-size: 13px; font-weight: bold; }
        .card-desc { font-size: 13px; color: #8e99a2; margin-bottom: 15px; line-height: 1.4; }

        /* Buttons */
        .btn { display: block; width: 100%; padding: 14px; border-radius: 10px; border: none; font-weight: bold; cursor: pointer; text-align: center; transition: 0.2s; font-size: 15px; }
        .btn-primary { background: var(--primary); color: white; }
        .btn-success { background: var(--success); color: white; }
        .btn-red { background: #ff4757; color: white; }
        .btn-fb { background: #1877f2; color: white; }
        .btn:active { transform: scale(0.97); }

        /* Ad Overlay */
        #ad-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(14, 22, 33, 0.99); z-index: 9999; flex-direction: column; align-items: center; justify-content: center; text-align: center; }
        .timer-display { width: 100px; height: 100px; border: 5px solid var(--primary); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 35px; color: var(--accent); margin-bottom: 20px; font-weight: bold; }

        /* Inputs */
        input, textarea { width: 100%; padding: 14px; background: #0e1621; border: 1px solid #2b3949; color: white; border-radius: 10px; margin-top: 10px; font-size: 14px; outline: none; }
        input:focus { border-color: var(--primary); }
    </style>
</head>
<body>

    <div id="ad-overlay">
        <div class="timer-display" id="timer-box">15</div>
        <h2 style="margin-bottom: 10px;">‡¶Ö‡ßç‡¶Ø‡¶æ‡¶° ‡¶≠‡ßá‡¶∞‡¶ø‡¶´‡¶æ‡¶á ‡¶π‡¶ö‡ßç‡¶õ‡ßá</h2>
        <p style="color: #8e99a2; padding: 0 40px; font-size: 14px;">‡¶¨‡ßç‡¶∞‡¶æ‡¶â‡¶ú‡¶æ‡¶∞‡ßá ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶ü‡¶ø ‡¶¶‡ßá‡¶ñ‡¶æ ‡¶∂‡ßá‡¶∑ ‡¶ï‡¶∞‡ßá ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶´‡¶ø‡¶∞‡ßá ‡¶Ü‡¶∏‡ßÅ‡¶®‡•§</p>
        <button id="collect-reward-btn" class="btn btn-success" style="display:none; width: 80%; margin-top: 20px;" onclick="addAdMoney()">‡¶¨‡ßã‡¶®‡¶æ‡¶∏ ‡¶∏‡¶Ç‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßÅ‡¶®</button>
    </div>

    <div class="header">
        <p class="balance-title" id="welcome-msg">‡¶π‡ßç‡¶Ø‡¶æ‡¶≤‡ßã, ‡¶á‡¶â‡¶ú‡¶æ‡¶∞</p>
        <div class="balance-amount" id="top-bal">‡ß≥ 0.00</div>
    </div>

    <div id="page-home" class="page active">
        <h3 class="section-title">‡¶∞‡ßá‡¶´‡¶æ‡¶∞ ‡¶è‡¶¨‡¶Ç ‡¶á‡¶®‡¶ï‡¶æ‡¶Æ</h3>
        <div class="card">
            <p class="card-desc">‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¨‡¶®‡ßç‡¶ß‡ßÅ‡¶¶‡ßá‡¶∞ ‡¶á‡¶®‡¶≠‡¶æ‡¶á‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®‡•§ ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡ßá ‡¶™‡¶æ‡¶¨‡ßá‡¶® ‡ßß‡ß¶ ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶¨‡ßã‡¶®‡¶æ‡¶∏‡•§ ‡¶â‡¶á‡¶•‡¶°‡ßç‡¶∞ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ö‡¶®‡ßç‡¶§‡¶§ ‡ßß‡ß¶ ‡¶ú‡¶® ‡¶∞‡ßá‡¶´‡¶æ‡¶∞ ‡¶™‡ßç‡¶∞‡ßü‡ßã‡¶ú‡¶®‡•§</p>
            <button class="btn btn-primary" onclick="copyMyInviteLink()">‡¶á‡¶®‡¶≠‡¶æ‡¶á‡¶ü ‡¶≤‡¶ø‡¶ô‡ßç‡¶ï ‡¶ï‡¶™‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶®</button>
        </div>
        <div class="card" style="text-align: center;">
            <p style="font-size: 12px; color: #8e99a2;">‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶Ü‡¶á‡¶°‡¶ø:</p>
            <p id="display-uid" style="font-weight: bold; color: var(--primary);">Loading...</p>
        </div>
    </div>

    <div id="page-task" class="page">
        <h3 class="section-title">‡¶∏‡¶¨‡¶ó‡ßÅ‡¶≤‡ßã ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï</h3>
        
        <div class="card">
            <div class="card-header">
                <span class="card-title">‡¶°‡ßá‡¶á‡¶≤‡¶ø ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°</span>
                <span class="reward-tag">‡ß≥ ‡ß´.‡ß¶‡ß¶</span>
            </div>
            <p class="card-desc">‡¶è‡¶ï‡¶ü‡¶ø ‡¶õ‡ßã‡¶ü ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶° ‡¶¶‡ßá‡¶ñ‡ßá ‡ß´ ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶Ü‡ßü ‡¶ï‡¶∞‡ßÅ‡¶®‡•§</p>
            <button class="btn btn-primary" onclick="startVideoAd()">‡¶Ö‡ßç‡¶Ø‡¶æ‡¶° ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®</button>
        </div>

        <div class="card" id="yt-card">
            <div class="card-header">
                <span class="card-title">‡¶á‡¶â‡¶ü‡¶ø‡¶â‡¶¨ ‡¶∏‡¶æ‡¶¨‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶æ‡¶á‡¶¨</span>
                <span class="reward-tag">‡ß≥ ‡ß´‡ß¶.‡ß¶‡ß¶</span>
            </div>
            <button class="btn btn-red" onclick="doSocialTask('https://www.youtube.com/@arshoppingmalls', 'yt')">Subscribe Channel</button>
            <button id="yt-claim" class="btn btn-success" style="display: none; margin-top: 10px;" onclick="claimSocialBonus('yt', 50)">‡¶ü‡¶æ‡¶ï‡¶æ ‡¶∏‡¶Ç‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßÅ‡¶®</button>
        </div>

        <div class="card" id="fb-card">
            <div class="card-header">
                <span class="card-title">‡¶´‡ßá‡¶∏‡¶¨‡ßÅ‡¶ï ‡¶´‡¶≤‡ßã</span>
                <span class="reward-tag">‡ß≥ ‡ß©‡ß¶.‡ß¶‡ß¶</span>
            </div>
            <button class="btn btn-fb" onclick="doSocialTask('https://www.facebook.com/profile.php?id=61585605224547', 'fb')">Follow Page</button>
            <button id="fb-claim" class="btn btn-success" style="display: none; margin-top: 10px;" onclick="claimSocialBonus('fb', 30)">‡¶ü‡¶æ‡¶ï‡¶æ ‡¶∏‡¶Ç‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßÅ‡¶®</button>
        </div>
    </div>

    <div id="page-withdraw" class="page">
        <h3 class="section-title">‡¶ü‡¶æ‡¶ï‡¶æ ‡¶â‡¶§‡ßç‡¶§‡ßã‡¶≤‡¶®</h3>
        <div class="card">
            <p style="font-size: 13px; color: #8e99a2; margin-bottom: 10px;">* ‡¶∏‡¶∞‡ßç‡¶¨‡¶®‡¶ø‡¶Æ‡ßç‡¶® ‡¶â‡¶§‡ßç‡¶§‡ßã‡¶≤‡¶® ‡ß´‡ß¶‡ß¶ ‡¶ü‡¶æ‡¶ï‡¶æ‡•§<br>* ‡ßß‡ß¶‡¶ü‡¶ø ‡¶∞‡ßá‡¶´‡¶æ‡¶∞ ‡¶•‡¶æ‡¶ï‡¶æ ‡¶¨‡¶æ‡¶ß‡ßç‡¶Ø‡¶§‡¶æ‡¶Æ‡ßÇ‡¶≤‡¶ï‡•§</p>
            <input type="number" id="draw-amount" placeholder="‡¶ü‡¶æ‡¶ï‡¶æ‡¶∞ ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®">
            <input type="text" id="draw-phone" placeholder="‡¶¨‡¶ø‡¶ï‡¶æ‡¶∂/‡¶®‡¶ó‡¶¶ ‡¶®‡¶æ‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞">
            <textarea id="draw-refs" rows="3" placeholder="‡ßß‡ß¶ ‡¶ú‡¶® ‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡ßá‡¶∞ ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡¶®‡ßá‡¶Æ ‡¶¶‡¶ø‡¶®..."></textarea>
            <button class="btn btn-primary" style="margin-top: 15px;" onclick="handleWithdrawRequest()">‡¶â‡¶á‡¶•‡¶°‡ßç‡¶∞ ‡¶∞‡¶ø‡¶ï‡ßã‡ßü‡ßá‡¶∏‡ßç‡¶ü ‡¶™‡¶æ‡¶†‡¶æ‡¶®</button>
        </div>
    </div>

    <nav class="nav-bar">
        <div class="nav-item active" onclick="switchTab('page-home', this)">üè†<br>Home</div>
        <div class="nav-item" onclick="switchTab('page-task', this)">üéØ<br>Task</div>
        <div class="nav-item" onclick="switchTab('page-withdraw', this)">üí∞<br>Withdraw</div>
    </nav>

    <script>
        let tg = window.Telegram.WebApp;
        tg.expand();

        // Database
        let userDB = JSON.parse(localStorage.getItem('panda_max_v1')) || { balance: 0, yt_done: false, fb_done: false };

        function updateDisplay() {
            document.getElementById('top-bal').innerText = "‡ß≥ " + userDB.balance.toFixed(2);
            if(userDB.yt_done) document.getElementById('yt-card').style.display = 'none';
            if(userDB.fb_done) document.getElementById('fb-card').style.display = 'none';
            localStorage.setItem('panda_max_v1', JSON.stringify(userDB));
        }

        function switchTab(pageId, navEl) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            document.getElementById(pageId).classList.add('active');
            navEl.classList.add('active');
        }

        // --- Ad System ---
        function startVideoAd() {
            tg.openLink("https://otieu.com/4/10557505");
            document.getElementById('ad-overlay').style.display = 'flex';
            document.getElementById('collect-reward-btn').style.display = 'none';
            
            let count = 15;
            let interval = setInterval(() => {
                count--;
                document.getElementById('timer-box').innerText = count;
                if(count <= 0) {
                    clearInterval(interval);
                    document.getElementById('timer-box').innerText = "‚úì";
                    document.getElementById('collect-reward-btn').style.display = 'block';
                }
            }, 1000);
        }

        function addAdMoney() {
            userDB.balance += 5;
            updateDisplay();
            document.getElementById('ad-overlay').style.display = 'none';
            tg.showAlert("‡ß´ ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏‡ßá ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá!");
        }

        // --- Social Tasks ---
        function doSocialTask(url, type) {
            tg.openLink(url);
            setTimeout(() => {
                document.getElementById(type + '-claim').style.display = 'block';
            }, 10000); // ‡ßß‡ß¶ ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶° ‡¶™‡¶∞ ‡¶ï‡ßç‡¶≤‡ßá‡¶á‡¶Æ ‡¶¨‡¶æ‡¶ü‡¶®
        }

        function claimSocialBonus(type, amt) {
            userDB.balance += amt;
            if(type === 'yt') userDB.yt_done = true; else userDB.fb_done = true;
            updateDisplay();
            tg.showAlert("‡¶∏‡¶æ‡¶´‡¶≤‡ßç‡¶Ø! ‡ß≥" + amt + " ‡¶Ø‡ßã‡¶ó ‡¶π‡ßü‡ßá‡¶õ‡ßá‡•§");
        }

        // --- Utils ---
        function copyMyInviteLink() {
            let uid = tg.initDataUnsafe.user ? tg.initDataUnsafe.user.id : "12345";
            tg.openLink("https://t.me/share/url?url=https://t.me/Red_Chilii_bot?start=" + uid);
        }

        function handleWithdrawRequest() {
            let amt = document.getElementById('draw-amount').value;
            let refs = document.getElementById('draw-refs').value;
            if(userDB.balance < 500) return tg.showAlert("‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏ ‡ß´‡ß¶‡ß¶ ‡¶ü‡¶æ‡¶ï‡¶æ‡¶∞ ‡¶ï‡¶Æ!");
            if(refs.length < 20) return tg.showAlert("‡¶â‡¶á‡¶•‡¶°‡ßç‡¶∞ ‡¶ï‡¶∞‡¶§‡ßá ‡ßß‡ß¶ ‡¶ú‡¶® ‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡ßá‡¶∞ ‡¶§‡¶•‡ßç‡¶Ø ‡¶¶‡¶ø‡¶®!");
            
            tg.showAlert("‡¶Ö‡¶®‡ßÅ‡¶∞‡ßã‡¶ß ‡¶∏‡¶´‡¶≤! ‡¶è‡¶°‡¶Æ‡¶ø‡¶® ‡¶°‡¶æ‡¶ü‡¶æ‡¶¨‡ßá‡¶ú ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡ßá ‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶ï‡¶∞‡¶¨‡ßá‡•§");
            userDB.balance -= parseFloat(amt);
            updateDisplay();
        }

        // Init
        if(tg.initDataUnsafe.user) {
            document.getElementById('welcome-msg').innerText = "‡¶π‡ßç‡¶Ø‡¶æ‡¶≤‡ßã, " + tg.initDataUnsafe.user.first_name;
            document.getElementById('display-uid').innerText = tg.initDataUnsafe.user.id;
        }
        updateDisplay();
    </script>
</body>
</html>
